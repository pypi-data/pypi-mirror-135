
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/machine-learning/estimate_soccer_value_bets.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_machine-learning_estimate_soccer_value_bets.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_machine-learning_estimate_soccer_value_bets.py:


=================
Soccer value bets
=================

This example illustrates how to estimate value bets for soccer fixtures by 
training a machine learning multi-output classifier.

.. GENERATED FROM PYTHON SOURCE LINES 9-18

.. code-block:: default


    # Author: Georgios Douzas <gdouzas@icloud.com>
    # Licence: MIT

    import numpy as np
    import pandas as pd
    from sportsbet.datasets import SoccerDataLoader
    from sklearn.neighbors import KNeighborsClassifier








.. GENERATED FROM PYTHON SOURCE LINES 19-21

Extracting the training data
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 23-25

We extract the training data for the spanish league. We also remove any
missing values and select the market average odds.

.. GENERATED FROM PYTHON SOURCE LINES 25-31

.. code-block:: default


    dataloader = SoccerDataLoader(param_grid={'league': ['Spain']})
    X_train, Y_train, _ = dataloader.extract_train_data(
        drop_na_thres=1.0, odds_type='market_average'
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Football-Data.co.uk: ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00




.. GENERATED FROM PYTHON SOURCE LINES 32-33

The input data:

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: default

    X_train






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>league</th>
          <th>division</th>
          <th>year</th>
          <th>home_team_soccer_power_index</th>
          <th>away_team_soccer_power_index</th>
          <th>home_team_probability_win</th>
          <th>away_team_probability_win</th>
          <th>probability_draw</th>
          <th>home_team_projected_score</th>
          <th>away_team_projected_score</th>
          <th>match_quality</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2016-08-19</th>
          <td>Malaga</td>
          <td>Osasuna</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>72.57</td>
          <td>56.93</td>
          <td>0.5475</td>
          <td>0.1897</td>
          <td>0.2628</td>
          <td>1.56</td>
          <td>0.70</td>
          <td>63.805561</td>
        </tr>
        <tr>
          <th>2016-08-19</th>
          <td>La Coruna</td>
          <td>Eibar</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>66.52</td>
          <td>62.29</td>
          <td>0.5003</td>
          <td>0.2260</td>
          <td>0.2738</td>
          <td>1.47</td>
          <td>0.79</td>
          <td>64.335545</td>
        </tr>
        <tr>
          <th>2016-08-20</th>
          <td>Barcelona</td>
          <td>Betis</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>96.35</td>
          <td>69.95</td>
          <td>0.9591</td>
          <td>0.0071</td>
          <td>0.0337</td>
          <td>3.40</td>
          <td>0.42</td>
          <td>81.054510</td>
        </tr>
        <tr>
          <th>2016-08-20</th>
          <td>Sevilla</td>
          <td>Espanol</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>78.76</td>
          <td>68.75</td>
          <td>0.5952</td>
          <td>0.1760</td>
          <td>0.2288</td>
          <td>1.89</td>
          <td>0.88</td>
          <td>73.415362</td>
        </tr>
        <tr>
          <th>2016-08-20</th>
          <td>Granada</td>
          <td>Villarreal</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>55.69</td>
          <td>76.79</td>
          <td>0.3194</td>
          <td>0.3917</td>
          <td>0.2889</td>
          <td>1.07</td>
          <td>1.19</td>
          <td>64.559709</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>2021-12-19</th>
          <td>Fuenlabrada</td>
          <td>Oviedo</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>23.93</td>
          <td>34.47</td>
          <td>0.3181</td>
          <td>0.3483</td>
          <td>0.3336</td>
          <td>0.97</td>
          <td>1.03</td>
          <td>28.248873</td>
        </tr>
        <tr>
          <th>2021-12-19</th>
          <td>Ponferradina</td>
          <td>Amorebieta</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>32.85</td>
          <td>25.44</td>
          <td>0.4926</td>
          <td>0.2281</td>
          <td>0.2793</td>
          <td>1.53</td>
          <td>0.95</td>
          <td>28.674009</td>
        </tr>
        <tr>
          <th>2021-12-31</th>
          <td>Burgos</td>
          <td>Amorebieta</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>25.64</td>
          <td>25.98</td>
          <td>0.3896</td>
          <td>0.3090</td>
          <td>0.3014</td>
          <td>1.26</td>
          <td>1.09</td>
          <td>25.808880</td>
        </tr>
        <tr>
          <th>2021-12-31</th>
          <td>Oviedo</td>
          <td>Ponferradina</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>34.04</td>
          <td>32.07</td>
          <td>0.4257</td>
          <td>0.2608</td>
          <td>0.3135</td>
          <td>1.24</td>
          <td>0.91</td>
          <td>33.025648</td>
        </tr>
        <tr>
          <th>2021-12-31</th>
          <td>Eibar</td>
          <td>Sociedad B</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>35.73</td>
          <td>25.54</td>
          <td>0.5271</td>
          <td>0.2011</td>
          <td>0.2718</td>
          <td>1.60</td>
          <td>0.88</td>
          <td>29.787635</td>
        </tr>
      </tbody>
    </table>
    <p>2724 rows × 13 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 36-37

The targets:

.. GENERATED FROM PYTHON SOURCE LINES 37-39

.. code-block:: default

    Y_train






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>away_win__full_time_goals</th>
          <th>draw__full_time_goals</th>
          <th>home_win__full_time_goals</th>
          <th>over_2.5__full_time_goals</th>
          <th>under_2.5__full_time_goals</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>1</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>3</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>4</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>2719</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2720</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2721</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2722</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2723</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <p>2724 rows × 5 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 40-42

Training a multi-output classifier
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 44-46

We train a :class:`~sklearn.neighbors.KNeighborsClassifier` using only numerical
features from the input data. We also use the extracted targets.

.. GENERATED FROM PYTHON SOURCE LINES 46-55

.. code-block:: default


    num_features = [
        col
        for col in X_train.columns
        if X_train[col].dtype in (np.dtype(int), np.dtype(float))
    ]
    clf = KNeighborsClassifier()
    clf.fit(X_train[num_features], Y_train)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    KNeighborsClassifier()



.. GENERATED FROM PYTHON SOURCE LINES 56-58

Extracting the fixtures data
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 60-62

We extract the fixtures data. The columns by default match the columns of the
training data.

.. GENERATED FROM PYTHON SOURCE LINES 62-65

.. code-block:: default


    X_fix, _, Odds_fix = dataloader.extract_fixtures_data()








.. GENERATED FROM PYTHON SOURCE LINES 66-67

The input data:

.. GENERATED FROM PYTHON SOURCE LINES 67-69

.. code-block:: default

    X_fix






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>league</th>
          <th>division</th>
          <th>year</th>
          <th>home_team_soccer_power_index</th>
          <th>away_team_soccer_power_index</th>
          <th>home_team_probability_win</th>
          <th>away_team_probability_win</th>
          <th>probability_draw</th>
          <th>home_team_projected_score</th>
          <th>away_team_projected_score</th>
          <th>match_quality</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2022-01-19</th>
          <td>Volos NFC</td>
          <td>Apollon</td>
          <td>Greece</td>
          <td>1</td>
          <td>2022</td>
          <td>28.01</td>
          <td>17.98</td>
          <td>0.5408</td>
          <td>0.2233</td>
          <td>0.2359</td>
          <td>1.86</td>
          <td>1.11</td>
          <td>21.901274</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Toulouse</td>
          <td>Nancy</td>
          <td>France</td>
          <td>2</td>
          <td>2022</td>
          <td>49.42</td>
          <td>21.70</td>
          <td>0.7299</td>
          <td>0.0985</td>
          <td>0.1716</td>
          <td>2.48</td>
          <td>0.80</td>
          <td>30.157874</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Amiens</td>
          <td>Ajaccio</td>
          <td>France</td>
          <td>2</td>
          <td>2022</td>
          <td>35.07</td>
          <td>33.24</td>
          <td>0.2896</td>
          <td>0.3429</td>
          <td>0.3674</td>
          <td>0.78</td>
          <td>0.87</td>
          <td>34.130487</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Montpellier</td>
          <td>Troyes</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>58.58</td>
          <td>50.44</td>
          <td>0.4956</td>
          <td>0.2383</td>
          <td>0.2661</td>
          <td>1.53</td>
          <td>0.97</td>
          <td>54.206113</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Lille</td>
          <td>Lorient</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>71.29</td>
          <td>49.23</td>
          <td>0.6553</td>
          <td>0.1131</td>
          <td>0.2316</td>
          <td>1.74</td>
          <td>0.56</td>
          <td>58.241067</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Clermont</td>
          <td>Strasbourg</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>50.37</td>
          <td>68.50</td>
          <td>0.2471</td>
          <td>0.5034</td>
          <td>0.2496</td>
          <td>1.11</td>
          <td>1.68</td>
          <td>58.052410</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Celta</td>
          <td>Osasuna</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>72.96</td>
          <td>67.38</td>
          <td>0.4928</td>
          <td>0.2258</td>
          <td>0.2814</td>
          <td>1.46</td>
          <td>0.89</td>
          <td>70.059068</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Genk</td>
          <td>Mechelen</td>
          <td>Belgium</td>
          <td>1</td>
          <td>2022</td>
          <td>57.62</td>
          <td>45.28</td>
          <td>0.5788</td>
          <td>0.2222</td>
          <td>0.1990</td>
          <td>2.33</td>
          <td>1.40</td>
          <td>50.710080</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Trabzonspor</td>
          <td>Giresunspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>58.51</td>
          <td>32.62</td>
          <td>0.6752</td>
          <td>0.0899</td>
          <td>0.2349</td>
          <td>1.68</td>
          <td>0.44</td>
          <td>41.887330</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Fenerbahce</td>
          <td>Altay</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>50.82</td>
          <td>25.50</td>
          <td>0.6821</td>
          <td>0.1183</td>
          <td>0.1996</td>
          <td>2.09</td>
          <td>0.73</td>
          <td>33.959906</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Rizespor</td>
          <td>Antalyaspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>26.65</td>
          <td>30.45</td>
          <td>0.3710</td>
          <td>0.3574</td>
          <td>0.2716</td>
          <td>1.33</td>
          <td>1.30</td>
          <td>28.423555</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Kayserispor</td>
          <td>Buyuksehyr</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>36.49</td>
          <td>48.19</td>
          <td>0.2791</td>
          <td>0.4473</td>
          <td>0.2736</td>
          <td>1.08</td>
          <td>1.44</td>
          <td>41.531722</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Lugo</td>
          <td>Almeria</td>
          <td>Spain</td>
          <td>2</td>
          <td>2022</td>
          <td>29.53</td>
          <td>43.44</td>
          <td>0.2335</td>
          <td>0.4879</td>
          <td>0.2786</td>
          <td>0.98</td>
          <td>1.54</td>
          <td>35.159194</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Goztep</td>
          <td>Sivasspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>34.33</td>
          <td>47.22</td>
          <td>0.3210</td>
          <td>0.4018</td>
          <td>0.2773</td>
          <td>1.17</td>
          <td>1.35</td>
          <td>39.756287</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Valencia</td>
          <td>Sevilla</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>68.99</td>
          <td>76.95</td>
          <td>0.3376</td>
          <td>0.3768</td>
          <td>0.2856</td>
          <td>1.20</td>
          <td>1.29</td>
          <td>72.752919</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Alanyaspor</td>
          <td>Hatayspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>40.25</td>
          <td>41.04</td>
          <td>0.4123</td>
          <td>0.3404</td>
          <td>0.2473</td>
          <td>1.63</td>
          <td>1.46</td>
          <td>40.641161</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Getafe</td>
          <td>Granada</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>68.92</td>
          <td>62.73</td>
          <td>0.4738</td>
          <td>0.2103</td>
          <td>0.3159</td>
          <td>1.23</td>
          <td>0.71</td>
          <td>65.679477</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Galatasaray</td>
          <td>Kasimpasa</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>46.80</td>
          <td>35.85</td>
          <td>0.5029</td>
          <td>0.2358</td>
          <td>0.2613</td>
          <td>1.58</td>
          <td>1.00</td>
          <td>40.599637</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 70-71

The market average odds:

.. GENERATED FROM PYTHON SOURCE LINES 71-73

.. code-block:: default

    Odds_fix






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>market_average__away_win__odds</th>
          <th>market_average__draw__odds</th>
          <th>market_average__home_win__odds</th>
          <th>market_average__over_2.5__odds</th>
          <th>market_average__under_2.5__odds</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>4.52</td>
          <td>3.64</td>
          <td>1.74</td>
          <td>1.97</td>
          <td>1.81</td>
        </tr>
        <tr>
          <th>1</th>
          <td>6.39</td>
          <td>4.19</td>
          <td>1.50</td>
          <td>1.75</td>
          <td>2.02</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2.42</td>
          <td>3.00</td>
          <td>3.14</td>
          <td>2.25</td>
          <td>1.62</td>
        </tr>
        <tr>
          <th>3</th>
          <td>4.43</td>
          <td>3.96</td>
          <td>1.75</td>
          <td>1.81</td>
          <td>2.02</td>
        </tr>
        <tr>
          <th>4</th>
          <td>6.33</td>
          <td>4.33</td>
          <td>1.51</td>
          <td>1.83</td>
          <td>1.98</td>
        </tr>
        <tr>
          <th>5</th>
          <td>2.27</td>
          <td>3.46</td>
          <td>3.12</td>
          <td>1.93</td>
          <td>1.87</td>
        </tr>
        <tr>
          <th>6</th>
          <td>4.45</td>
          <td>3.41</td>
          <td>1.89</td>
          <td>2.22</td>
          <td>1.67</td>
        </tr>
        <tr>
          <th>7</th>
          <td>4.63</td>
          <td>4.16</td>
          <td>1.65</td>
          <td>1.48</td>
          <td>2.59</td>
        </tr>
        <tr>
          <th>8</th>
          <td>5.30</td>
          <td>3.93</td>
          <td>1.62</td>
          <td>1.91</td>
          <td>1.89</td>
        </tr>
        <tr>
          <th>9</th>
          <td>7.55</td>
          <td>4.85</td>
          <td>1.38</td>
          <td>1.60</td>
          <td>2.32</td>
        </tr>
        <tr>
          <th>10</th>
          <td>2.65</td>
          <td>3.37</td>
          <td>2.58</td>
          <td>1.95</td>
          <td>1.85</td>
        </tr>
        <tr>
          <th>11</th>
          <td>2.19</td>
          <td>3.25</td>
          <td>3.37</td>
          <td>1.98</td>
          <td>1.82</td>
        </tr>
        <tr>
          <th>12</th>
          <td>2.18</td>
          <td>3.16</td>
          <td>3.39</td>
          <td>2.15</td>
          <td>1.68</td>
        </tr>
        <tr>
          <th>13</th>
          <td>2.93</td>
          <td>3.23</td>
          <td>2.43</td>
          <td>2.10</td>
          <td>1.73</td>
        </tr>
        <tr>
          <th>14</th>
          <td>2.38</td>
          <td>3.17</td>
          <td>3.23</td>
          <td>2.31</td>
          <td>1.62</td>
        </tr>
        <tr>
          <th>15</th>
          <td>2.85</td>
          <td>3.47</td>
          <td>2.36</td>
          <td>1.74</td>
          <td>2.08</td>
        </tr>
        <tr>
          <th>16</th>
          <td>3.90</td>
          <td>3.10</td>
          <td>2.13</td>
          <td>2.59</td>
          <td>1.49</td>
        </tr>
        <tr>
          <th>17</th>
          <td>4.66</td>
          <td>3.80</td>
          <td>1.71</td>
          <td>1.83</td>
          <td>1.96</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 74-76

Estimating the value bets
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 78-79

We can estimate the value bets by using the fitted classifier.

.. GENERATED FROM PYTHON SOURCE LINES 79-93

.. code-block:: default


    Y_pred_prob = np.concatenate(
        [prob[:, 1].reshape(-1, 1) for prob in clf.predict_proba(X_fix[num_features])],
        axis=1,
    )
    X_fix_info = X_fix[['home_team', 'away_team']].reset_index()
    value_bets = pd.concat([X_fix_info, Y_pred_prob * Odds_fix > 1], axis=1).set_index(
        'date'
    )
    value_bets.rename(
        columns={
            col: col.split('__')[1] for col in value_bets.columns if col.endswith('odds')
        }
    )





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>away_win</th>
          <th>draw</th>
          <th>home_win</th>
          <th>over_2.5</th>
          <th>under_2.5</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2022-01-19</th>
          <td>Volos NFC</td>
          <td>Apollon</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Toulouse</td>
          <td>Nancy</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Amiens</td>
          <td>Ajaccio</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Montpellier</td>
          <td>Troyes</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Lille</td>
          <td>Lorient</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Clermont</td>
          <td>Strasbourg</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Celta</td>
          <td>Osasuna</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Genk</td>
          <td>Mechelen</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Trabzonspor</td>
          <td>Giresunspor</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Fenerbahce</td>
          <td>Altay</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Rizespor</td>
          <td>Antalyaspor</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Kayserispor</td>
          <td>Buyuksehyr</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Lugo</td>
          <td>Almeria</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Goztep</td>
          <td>Sivasspor</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-19</th>
          <td>Valencia</td>
          <td>Sevilla</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Alanyaspor</td>
          <td>Hatayspor</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Getafe</td>
          <td>Granada</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2022-01-20</th>
          <td>Galatasaray</td>
          <td>Kasimpasa</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  36.774 seconds)


.. _sphx_glr_download_auto_examples_machine-learning_estimate_soccer_value_bets.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: estimate_soccer_value_bets.py <estimate_soccer_value_bets.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: estimate_soccer_value_bets.ipynb <estimate_soccer_value_bets.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_

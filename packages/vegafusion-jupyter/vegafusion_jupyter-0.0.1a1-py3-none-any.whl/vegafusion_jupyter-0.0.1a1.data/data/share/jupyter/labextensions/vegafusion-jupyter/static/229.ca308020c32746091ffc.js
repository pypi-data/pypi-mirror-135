(self.webpackChunkvegafusion_jupyter=self.webpackChunkvegafusion_jupyter||[]).push([[229],{657:(e,n,t)=>{"use strict";t.d(n,{Y:()=>o,o:()=>s});const i=t(147),o=i.version,s=i.name},229:(e,n,t)=>{"use strict";t.r(n),t.d(n,{VegaFusionModel:()=>a,VegaFusionView:()=>l});var i=t(565),o=t(657);t(204),t(926);const s={CLICK_TO_VIEW_ACTIONS:"Click to view actions",PNG_ACTION:"Save as PNG",SVG_ACTION:"Save as SVG"};class a extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:a.model_name,_model_module:a.model_module,_model_module_version:a.model_module_version,_view_name:a.view_name,_view_module:a.view_module,_view_module_version:a.view_module_version,spec:null,full_vega_spec:null,client_vega_spec:null,server_vega_spec:null,vegafusion_handle:null,verbose:null,debounce_wait:30,debounce_max_wait:60,download_source_link:null})}}a.serializers=Object.assign({},i.DOMWidgetModel.serializers),a.model_name="VegaFusionModel",a.model_module=o.o,a.model_module_version=o.Y,a.view_name="VegaFusionView",a.view_module=o.o,a.view_module_version=o.Y;class l extends i.DOMWidgetView{constructor(){super(...arguments),this.viewElement=document.createElement("div"),this.containerElement=document.createElement("div"),this.menuElement=document.createElement("div")}generate_menu(){const e=document.createElement("details");e.title=s.CLICK_TO_VIEW_ACTIONS;const n=document.createElement("summary");n.innerHTML='<svg version="1.1" viewBox="0.0 0.0 946.4776902887139 673.4829396325459" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><clipPath id="p.0"><path d="m0 0l946.47766 0l0 673.4829l-946.47766 0l0 -673.4829z" clip-rule="nonzero"/></clipPath><g clip-path="url(#p.0)"><path fill="#000000" fill-opacity="0.0" d="m0 0l946.47766 0l0 673.4829l-946.47766 0z" fill-rule="evenodd"/><path fill="#434a56" d="m241.20998 355.4672l228.50392 0l0 318.04727l-228.50392 0z" fill-rule="evenodd"/><path fill="#434a56" d="m601.9989 0l-65.49762 177.0l343.29565 0.9973755l65.87903 -177.99738z" fill-rule="evenodd"/><path fill="#434a56" d="m505.0006 317.5013l-42.4993 177.0l302.89688 0.15222168l64.59503 -177.88187z" fill-rule="evenodd"/><path fill="#434a56" d="m0.46194226 -0.04330709l240.56693 673.5696l127.509186 -285.16272l-140.021 -388.40683z" fill-rule="evenodd"/><path fill="#434a56" d="m712.8845 -0.01968504l-242.1799 673.54333l-229.69412 0l242.1799 -673.54333z" fill-rule="evenodd"/></g></svg>',e.append(n),document.addEventListener("click",(n=>{e.contains(n.target)||e.removeAttribute("open")}));const t=document.createElement("div");e.append(t),t.classList.add("vegafusion-actions");for(const e of["svg","png"]){let n=1;const i=s[`${e.toUpperCase()}_ACTION`],o=document.createElement("a");o.text=i,o.href="#",o.target="_blank",o.download=`visualization.${e}`,o.title="";let a=this;o.addEventListener("mousedown",(async function(t){t.preventDefault(),a.vegafusion_handle&&(this.href=await a.vegafusion_handle.to_image_url(e,n))})),t.append(o)}t.append(document.createElement("hr"));const i=document.createElement("a");i.text="About VegaFusion",i.href="",i.target="_blank",i.title="",t.append(i);const o=document.createElement("a"),a="https://www.gnu.org/licenses/agpl-3.0.en.html";o.text="AGPLv3 License",o.href=a,o.target="_blank",o.title=a,t.append(o);const l=this.model.get("download_source_link");if(l){const e=document.createElement("a");e.text="Download Source",e.href=l,e.target="_blank",e.title=l,t.append(e)}else{const e=document.createElement("p");e.classList.add("source-msg"),e.textContent="VegaFusion's AGPLv3 license requires the author to provide this application's source code upon request",e.title="",t.append(e)}return e}async render(){const{render_vegafusion:e}=await t.e(897).then(t.t.bind(t,897,23));this.render_vegafusion=e;const{compile:n}=await t.e(453).then(t.t.bind(t,453,23));this.vegalite_compile=n,this.containerElement.appendChild(this.viewElement),this.containerElement.classList.add("chart-wrapper"),this.el.appendChild(this.containerElement),this.el.appendChild(this.menuElement),this.el.classList.add("vegafusion-embed"),this.el.classList.add("has-actions"),this.value_changed(),this.model.on("change:spec",this.value_changed,this),this.model.on("change:verbose",this.value_changed,this),this.model.on("change:debounce_wait",this.value_changed,this),this.model.on("change:debounce_max_wait",this.value_changed,this),this.model.on("change:download_source_link",this.value_changed,this),this.model.on("msg:custom",((e,n)=>{this.model.get("verbose")&&console.log("VegaFusion(js): Received response");let t=new Uint8Array(n[0].buffer);this.vegafusion_handle.receive(t)}))}value_changed(){for(;this.menuElement.lastChild;)this.menuElement.removeChild(this.menuElement.lastChild);this.menuElement.appendChild(this.generate_menu());let e=this.model.get("spec");if(null!==e){let n,t=JSON.parse(e);if(t.$schema.endsWith("schema/vega/v5.json"))n=e;else{let e=this.vegalite_compile(t);n=JSON.stringify(e.spec)}this.vegafusion_handle=this.render_vegafusion(this.viewElement,n,this.model.get("verbose")||!1,this.model.get("debounce_wait")||30,this.model.get("debounce_max_wait"),(e=>{this.model.get("verbose")&&console.log("VegaFusion(js): Send request"),this.send({type:"request"},[e])})),this.model.set("full_vega_spec",n),this.model.set("client_vega_spec",this.vegafusion_handle.client_spec_json()),this.model.set("server_vega_spec",this.vegafusion_handle.server_spec_json()),this.model.set("comm_plan",this.vegafusion_handle.comm_plan_json()),this.touch()}}}},949:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var i=t(81),o=t.n(i),s=t(645),a=t.n(s)()(o());a.push([e.id,'.vegafusion-embed {\n  min-height: 40px;\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n  overflow: visible;\n}\n.vegafusion-embed.has-actions {\n  padding-right: 38px;\n}\n.vegafusion-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vegafusion-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  outline: none;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vegafusion-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vegafusion-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vegafusion-embed summary svg {\n  width: 16px;\n  height: 16px;\n}\n.vegafusion-embed details[open] summary {\n  opacity: 0.5;\n}\n.vegafusion-embed:hover summary, .vegafusion-embed:focus summary {\n  opacity: 0.7 !important;\n  transition: opacity 0.2s ease;\n}\n.vegafusion-embed .vegafusion-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vegafusion-embed .vegafusion-actions hr {\n  width: auto;\n  height: 1px;\n  border: none;\n  background-color: #434a56;\n  margin: 4px 10px 4px 10px;\n  opacity: 50%;\n}\n.vegafusion-embed .vegafusion-actions .source-msg {\n  padding: 4px 16px;\n  font-family: sans-serif;\n  font-size: 10px;\n  font-weight: 400;\n  max-width: 180px;\n  color: #CD5C5C;\n}\n.vegafusion-embed .vegafusion-actions a {\n  padding: 4px 16px;\n  font-family: sans-serif;\n  font-size: 12px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vegafusion-embed .vegafusion-actions a:hover {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vegafusion-embed .vegafusion-actions::before, .vegafusion-embed .vegafusion-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n  pointer-events: none;\n}\n.vegafusion-embed .vegafusion-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vegafusion-embed .vegafusion-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vegafusion-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vegafusion-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vegafusion-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n',""]);const l=a},889:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var i=t(81),o=t.n(i),s=t(645),a=t.n(s)()(o());a.push([e.id,".vegafusion-loading {\n  color: red;\n  background: aqua;\n}\n.vegafusion-loading .inner {\n  width: 100px;\n}\n",""]);const l=a},645:e=>{"use strict";e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",i=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),i&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),i&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,i,o,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var l=0;l<this.length;l++){var r=this[l][0];null!=r&&(a[r]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);i&&a[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),n.push(c))}},n}},81:e=>{"use strict";e.exports=function(e){return e[1]}},926:(e,n,t)=>{var i=t(379),o=t(949);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);i(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},204:(e,n,t)=>{var i=t(379),o=t(889);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.id,o,""]]);i(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},379:(e,n,t)=>{"use strict";var i,o=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),s=[];function a(e){for(var n=-1,t=0;t<s.length;t++)if(s[t].identifier===e){n=t;break}return n}function l(e,n){for(var t={},i=[],o=0;o<e.length;o++){var l=e[o],r=n.base?l[0]+n.base:l[0],d=t[r]||0,c="".concat(r," ").concat(d);t[r]=d+1;var u=a(c),p={css:l[1],media:l[2],sourceMap:l[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:c,updater:f(p,n),references:1}),i.push(c)}return i}function r(e){var n=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=t.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){n.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(n);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}return n}var d,c=(d=[],function(e,n){return d[e]=n,d.filter(Boolean).join("\n")});function u(e,n,t,i){var o=t?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(n,o);else{var s=document.createTextNode(o),a=e.childNodes;a[n]&&e.removeChild(a[n]),a.length?e.insertBefore(s,a[n]):e.appendChild(s)}}function p(e,n,t){var i=t.css,o=t.media,s=t.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var m=null,h=0;function f(e,n){var t,i,o;if(n.singleton){var s=h++;t=m||(m=r(n)),i=u.bind(null,t,s,!1),o=u.bind(null,t,s,!0)}else t=r(n),i=p.bind(null,t,n),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return i(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;i(e=n)}else o()}}e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var t=l(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<t.length;i++){var o=a(t[i]);s[o].references--}for(var r=l(e,n),d=0;d<t.length;d++){var c=a(t[d]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}t=r}}}},147:e=>{"use strict";e.exports=JSON.parse('{"name":"vegafusion-jupyter","version":"0.0.1-alpha.2","description":"Altair Jupyter Widget library that relies on VegaFusion for serverside calculations","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","dist/*.wasm","css/*.css","css/*.scss","images/*.svg"],"homepage":"https://github.com/vegafusion/vegafusion","bugs":{"url":"https://github.com/vegafusion/vegafusion/issues"},"license":"AGPL-3.0-or-later","author":{"name":"Jon Mease","email":"jonmmease@gmail.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/jonmmease/vegafusion"},"scripts":{"build":"npm run build:lib && npm run build:nbextension && npm run build:labextension:dev","build:prod":"npm run clean && npm run build:lib && npm run build:nbextension && npm run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc && sass scss:css","build:nbextension":"webpack","clean":"npm run clean:lib && npm run clean:build && npm run clean:dist && npm run clean:nbextension && npm run clean:labextension","clean:build":"rimraf build","clean:dist":"rimraf dist","clean:lib":"rimraf lib","clean:labextension":"rimraf vegafusion_jupyter/labextension","clean:nbextension":"rimraf vegafusion_jupyter/nbextension/* && cp src/nbextension/extension.js vegafusion_jupyter/nbextension/","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"npm run build:lib","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch ."},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2.0.0 || ^3.0.0 || ^4.0.0","@jupyterlab/notebook":"^3.0.0 || ^4.0.0","marked":"4.0.10","vega":"5.21.0","vega-lite":"^4.17.0","vega-tooltip":"^0.27.0","vegafusion-wasm":"0.0.1-alpha.5"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@types/jest":"^26.0.0","@types/webpack-env":"^1.16.3","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","css-loader":"6.5.1","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","sass":"^1.45.2","source-map-loader":"^1.1.3","style-loader":"^1.0.0","svg-inline-loader":"^0.8.2","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.65.0","webpack-cli":"^4.9.1","webpack-require-from":"^1.8.6"},"jupyterlab":{"extension":"lib/plugin","outputDir":"vegafusion_jupyter/labextension/","webpackConfig":"webpack.config.experimental.js","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);
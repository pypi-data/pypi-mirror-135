"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[834],{1815:function(e,n,t){t.d(n,{Y:function(){return r}});var r={}},3834:function(e,n,t){t.r(n);var r=t(5666),o=t.n(r),a=t(7673),c=t(9604),i=t(3186),u=t(1815);function s(e,n,t,r,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void t(s)}i.done?n(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function c(e){s(a,r,o,c,i,"next",e)}function i(e){s(a,r,o,c,i,"throw",e)}c(void 0)}))}}function f(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(t.push(c.value),!n||t.length!==n);r=!0);}catch(u){o=!0,a=u}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var m="",p="",v=[],h=[],y=[],g={};function b(e){return w.apply(this,arguments)}function w(){return(w=l(o().mark((function e(n){var t,r,a,c,i,u,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.ns,r=n.type,a=n.version,c="namespace=".concat(t,"&type=").concat(r,"&version=").concat(a),!g[c]){e.next=4;break}return e.abrupt("return",g[c]);case 4:return e.next=6,fetch("/api/registry/schema?namespace=".concat(t,"&type=").concat(r,"&version=").concat(a));case 6:if((i=e.sent).ok){e.next=11;break}return e.next=10,i.json();case 10:throw e.sent;case 11:return e.next=13,i.json();case 13:function o(e,n){var t=void 0===n?0:n;0===t&&e.title&&(s+=e.title+"\n\n");var r=e.properties||e.items.properties;r&&Object.keys(r).forEach((function(n){var a,c,i=r[n],u=null===(a=e.required)||void 0===a?void 0:a.find((function(e){return e===n}));s+=(0!==t?" ".repeat(2*t)+"- ":"- ")+"**"+n+"**"+(u?" _(required)_":"")+": `{".concat(i.type,"}` ").concat(null!==(c=i.title)&&void 0!==c?c:"_no description_","\n\n"),"object"===i.type&&o(i,t+1),"array"===i.type&&o(i,t+1)}))}return u=e.sent,s="",o(u),g[c]=s,e.abrupt("return",s);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c._m.init().then(l(o().mark((function e(n){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/registry/namespaces?with-types=true").then(l(o().mark((function e(t){var r,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=4;break}return e.next=3,t.json();case 3:throw e.sent;case 4:return e.next=6,t.json();case 6:r=e.sent,a=Object.keys(r),c=[],a.forEach((function(e){var n=r[e];n.types.forEach((function(t){c.push({type:"object",properties:{ns:{description:n.title,enum:[e]},type:{enum:[t.name]},version:{enum:[t.version]}}})}))})),n.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,trailingCommas:"ignore",allowComments:!0,schemas:[{uri:"http://fact-explorer/header-schema.json",fileMatch:["header.json"],schema:{type:"object",properties:{id:{type:"string"},aggIds:{type:"array",items:{type:"string"}},ns:{enum:a},type:{type:"string"},version:{type:"integer"}},anyOf:c}}]});case 11:case"end":return e.stop()}}),e)})))).catch((function(e){console.error("Could not fetch namespaces with types from registry."),console.error(e)})),t="fact-explorer.focusAggId",r="fact-explorer.mergeAggId",n.editor.registerCommand(t,(function(e,n){var r;u.Y.onFocusAggId?null===(r=u.Y.onFocusAggId)||void 0===r||r.call(u.Y,n.aggId):alert('Command "'.concat(t,'" is not handled correctly.'))})),n.editor.registerCommand(r,(function(e,n){var r;u.Y.onMergeAggId?null===(r=u.Y.onMergeAggId)||void 0===r||r.call(u.Y,n.aggId):alert('Command "'.concat(t,'" is not handled correctly.'))})),n.languages.registerCodeLensProvider("json",{provideCodeLenses:function(e,t){if(e.uri.path.startsWith("/result/")){var r="".concat(e.id,"-").concat(e.getVersionId());if(r!==m){var o=(0,a.Qc)(e.getValue()),c=[],u=!0,s=!1,l=void 0;try{for(var f,d=(0,a.hZ)(o,(function(e){return"enter"===e.phase}))[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var p=f.value,v=p.node;p.parent,p.phase;"Member"===v.type&&"_ts"===v.name.value&&"Number"===v.value.type&&c.push({node:v,title:(0,i.Z)(v.value.value)})}}catch(h){s=!0,l=h}finally{try{u||null==d.return||d.return()}finally{if(s)throw l}}m=r,y=c}return{lenses:y.map((function(e){return{range:new n.Range(e.node.loc.start.line,e.node.loc.start.column,e.node.loc.end.line,e.node.loc.end.column),command:{id:"",title:e.title}}})),dispose:function(){}}}},resolveCodeLens:function(e,n,t){return n}}),n.languages.registerHoverProvider("json",{provideHover:function(e,o){if("/result/search.json"===e.uri.path){var c="".concat(e.id,"-").concat(e.getVersionId());if(c!==p){var i=(0,a.Qc)(e.getValue()),u=[],s=[],l=!0,m=!1,y=void 0;try{for(var g,w=(0,a.hZ)(i,(function(e){return"enter"===e.phase}))[Symbol.iterator]();!(l=(g=w.next()).done);l=!0){var j=g.value,x=j.node;j.parent,j.phase;if("Member"===x.type&&"aggIds"===x.name.value&&"Array"===x.value.type){var I,A=x.value.elements.filter((function(e){return"String"===e.type}));(I=u).push.apply(I,d(A))}if("Object"===x.type&&2===x.members.length&&"header"===x.members[0].name.value&&"payload"===x.members[1].name.value){var k=f(x.members,2),C=k[0],N=k[1],_=C.value.members.find((function(e){return"ns"===e.name.value})).value.value,O=C.value.members.find((function(e){return"type"===e.name.value})).value.value,E=C.value.members.find((function(e){return"version"===e.name.value})).value.value;s.push({node:N,ns:_,type:O,version:E})}}}catch(F){m=!0,y=F}finally{try{l||null==w.return||w.return()}finally{if(m)throw y}}p=c,v=u,h=s}var S=v.find((function(e){return e.loc.start.line===o.lineNumber&&e.loc.end.line===o.lineNumber&&e.loc.start.column<=o.column&&e.loc.end.column>=o.column}));if(S){var Y=encodeURIComponent(JSON.stringify({aggId:S.value}));return{range:new n.Range(S.loc.start.line,S.loc.start.column,S.loc.end.line,S.loc.end.column),contents:[{value:"[".concat("Focus","](command:").concat(t,"?").concat(Y,' "').concat("Filter for this specific aggId.",'") | [').concat("Add to current filter","](command:").concat(r,"?").concat(Y,' "').concat("Adds this specific aggId to the current filter.",'")'),isTrusted:!0}]}}var M=h.find((function(e){var n=e.node;return(n.loc.start.line<o.lineNumber||n.loc.start.line===o.lineNumber&&n.loc.start.column<=o.column)&&(n.loc.end.line>o.lineNumber||n.loc.end.line===o.lineNumber&&n.loc.end.column>=o.column)}));return M?b(M).then((function(e){return{range:new n.Range(o.lineNumber,o.column,o.lineNumber,o.column),contents:[{value:e,isTrusted:!0}]}})).catch((function(e){return console.error("Could not fetch schema from registry."),console.error(e),null})):null}}});case 7:case"end":return e.stop()}}),e)}))))}}]);